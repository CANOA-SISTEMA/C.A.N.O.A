<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>3 chances</title>

<style>
:root{
  --bg:#000;
  --accent:#ff3b3b;
  --muted:#777;
  --box-h:45px;
  --box-w:35px;
}

html,body{
  height:100%;
  margin:0;
  background:var(--bg);
  color:#ddd;
  font-family:system-ui, monospace;
  overflow:hidden;
}

.wrap{
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:22px;
}

.glitch{
  font-size:28px;
  animation:glitch 1s infinite;
}

@keyframes glitch{
  0%{text-shadow:2px 0 var(--accent),-2px 0 cyan}
  50%{text-shadow:-2px 0 var(--accent),2px 0 cyan}
  100%{text-shadow:2px 0 var(--accent),-2px 0 cyan}
}

.password-line{
  display:flex;
  gap:12px;
}

.char{
  width:var(--box-w);
  height:var(--box-h);
  border-bottom:3px solid #444;
}

.char.filled{
  border-bottom-color:var(--accent);
}

.sr-only{
  position:absolute;
  left:-9999px;
}

.shake{
  animation:shake .35s;
}

@keyframes shake{
  0%{transform:translate(2px,2px)}
  50%{transform:translate(-3px,2px)}
  100%{transform:none}
}

/* OVERLAY */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  z-index:999;
  align-items:center;
  justify-content:center;
  text-align:center;
}

.overlay.show{display:flex}

/* PROGRESS BAR — CORRIGIDA */
.progress{
  position:fixed;
  bottom:0;
  left:0;
  height:6px;
  width:0%;
  background:var(--accent);
  z-index:2147483647; /* força acima de tudo */
  display:none;
}

/* SCREEN GLITCH */
.screen-glitch{
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:0;
  z-index:998;
}

.screen-glitch.active{
  opacity:1;
  animation:screenGlitch .8s linear;
}

@keyframes screenGlitch{
  0%{transform:translate(0)}
  30%{transform:translate(-5px,3px)}
  60%{transform:translate(4px,-2px)}
  100%{transform:none}
}
</style>
</head>

<body>

<div class="wrap" id="wrap">
  <div class="glitch">3 chances</div>
  <div class="password-line" id="boxes"></div>
  <input id="input" class="sr-only" type="password" maxlength="7">
</div>

<div class="overlay" id="overlay">
  <div>
    <h2>Acesso bloqueado</h2>
    <p>Aguarde…</p>
  </div>
</div>

<div class="progress" id="progress"></div>
<div class="screen-glitch" id="screenGlitch"></div>

<script>
const PASS_HASH="f97ac9e04309ce602c5026a251aa2b4523523175ce13b3598399db03b263b4ac";
const MAX_ATTEMPTS=3;
const LEN=7;
const YT="CYcbnFL2HS4";

const input=document.getElementById("input");
const boxes=document.getElementById("boxes");
const overlay=document.getElementById("overlay");
const progress=document.getElementById("progress");
const wrap=document.getElementById("wrap");
const glitch=document.getElementById("screenGlitch");

let attempts=0;
let interval=null;

for(let i=0;i<LEN;i++){
  const d=document.createElement("div");
  d.className="char";
  boxes.appendChild(d);
}

function updateBoxes(v){
  [...boxes.children].forEach((b,i)=>b.classList.toggle("filled",i<v.length));
}

async function sha256(t){
  const e=new TextEncoder().encode(t);
  const h=await crypto.subtle.digest("SHA-256",e);
  return [...new Uint8Array(h)].map(b=>b.toString(16).padStart(2,"0")).join("");
}

function chaos(){
  overlay.classList.add("show");
  glitch.classList.add("active");
  setTimeout(()=>glitch.classList.remove("active"),800);

  progress.style.display="block";
  progress.style.width="0%";

  let p=0;
  clearInterval(interval);
  interval=setInterval(()=>{
    p++;
    progress.style.width=p+"%";
    if(p>=100){
      clearInterval(interval);
      progress.style.display="none";
      overlay.classList.remove("show");
      attempts=0;
    }
  },50);

  // YOUTUBE
  const iframe=document.createElement("iframe");
  iframe.src=`https://www.youtube.com/embed/${YT}?autoplay=1&controls=0`;
  iframe.allow="autoplay";
  iframe.style.display="none";
  document.body.appendChild(iframe);
}

input.addEventListener("input",e=>updateBoxes(e.target.value));

input.addEventListener("keydown",async e=>{
  if(e.key==="Enter"){
    const v=input.value;
    if(v.length!==LEN)return;

    if(await sha256(v)===PASS_HASH){
      alert("Acesso liberado");
      attempts=0;
    }else{
      attempts++;
      wrap.classList.add("shake");
      setTimeout(()=>wrap.classList.remove("shake"),350);
      input.value="";
      updateBoxes("");

      if(attempts>=MAX_ATTEMPTS) chaos();
    }
  }
});

wrap.addEventListener("click",()=>input.focus());
window.onload=()=>input.focus();
</script>

</body>
</html>
